# ReferenceError: originalImageFile is not defined - Fix

## Error
```
Uncaught (in promise) ReferenceError: originalImageFile is not defined
    at resetForm (CardCreateEditForm.vue:485:5)
    at initializeForm (CardCreateEditForm.vue:467:9)
```

## Root Cause

During the refactoring to support dual image storage, I initially added an `originalImageFile` ref but then removed it in favor of using just `imageFile` for the original image. However, there were still 4 references to `originalImageFile` left in the code:

1. In `resetForm()` - trying to reset `originalImageFile.value`
2. In `handleImageUpload()` - trying to set `originalImageFile.value`
3. In `handleCropCancelled()` - trying to reset `originalImageFile.value`
4. In `processImageFile()` - trying to set `originalImageFile.value`

## Fix Applied

### CardCreateEditForm.vue

**Changed all `originalImageFile` references to use `imageFile` or `croppedImageFile`:**

1. **In `resetForm()`**:
```javascript
// Before (BROKEN)
originalImageFile.value = null;

// After (FIXED)
imageFile.value = null;
croppedImageFile.value = null;
```

2. **In `handleImageUpload()`**:
```javascript
// Before (BROKEN)
originalImageFile.value = file;

// After (FIXED)
imageFile.value = file;
```

3. **In `handleCropCancelled()`**:
```javascript
// Before (BROKEN)
originalImageFile.value = null;

// After (FIXED)
imageFile.value = null;
croppedImageFile.value = null;
```

4. **In `processImageFile()`**:
```javascript
// Before (BROKEN)
imageFile.value = file;
originalImageFile.value = file;

// After (FIXED)
imageFile.value = file;  // Only need to set once
```

### CardContentCreateEditForm.vue

**Also updated `resetForm()` to reset `croppedImageFile`**:
```javascript
const resetForm = () => {
    // ... other resets
    imageFile.value = null;
    croppedImageFile.value = null;  // Added this line
    // ... other resets
};
```

## Correct Ref Structure

The component now uses only TWO image refs:

```javascript
const imageFile = ref(null);        // Original uploaded file (raw)
const croppedImageFile = ref(null); // Cropped image file
```

**NOT:**
```javascript
const originalImageFile = ref(null); // ❌ REMOVED - redundant with imageFile
```

## Naming Clarification

- **`imageFile`** = The original, raw uploaded file (before cropping)
- **`croppedImageFile`** = The cropped/processed version generated by ImageCropper
- ~~**`originalImageFile`**~~ = ❌ Removed (was redundant with `imageFile`)

## Files Fixed

1. ✅ `src/components/CardComponents/CardCreateEditForm.vue`
   - Removed 4 references to `originalImageFile`
   - All references now use `imageFile` and `croppedImageFile`

2. ✅ `src/components/CardContent/CardContentCreateEditForm.vue`
   - Added `croppedImageFile` reset to `resetForm()`

## Testing

After this fix:
- ✅ Component mounts without errors
- ✅ Image upload works
- ✅ Cropping works
- ✅ Form reset works
- ✅ Cancel crop works

## Status

✅ **FIXED** - All references to non-existent `originalImageFile` removed and replaced with correct refs.

